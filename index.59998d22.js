function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},a=t.parcelRequired7c6;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return r[e]=a,t.call(a.exports,a,a.exports),a.exports}var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){n[e]=t},t.parcelRequired7c6=a),a("98X4p"),a("9M0Rn"),a("gScR6"),a("1wH5c");var l=a("6mZGd"),o=a("bGr86");l=a("6mZGd"),o=a("bGr86");var s=e(a("amrNH")).template({1:function(e,t,r,n,a){var l,o=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,i="function",c=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"  <option value="+c(typeof(l=null!=(l=u(r,"id")||(null!=t?u(t,"id"):t))?l:s)===i?l.call(o,{name:"id",hash:{},data:a,loc:{start:{line:2,column:16},end:{line:2,column:22}}}):l)+">"+c(typeof(l=null!=(l=u(r,"name")||(null!=t?u(t,"name"):t))?l:s)===i?l.call(o,{name:"name",hash:{},data:a,loc:{start:{line:2,column:23},end:{line:2,column:31}}}):l)+"</option>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,r,n,a){var l;return null!=(l=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(r,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:3,column:9}}}))?l:""},useData:!0}),i=a("cEPyp"),c=a("9M0Rn");var u=e(a("amrNH")).template({1:function(e,t,r,n,a){var l=e.lambda,o=e.escapeExpression;return"  <option value="+o(l(t,t))+">"+o(l(t,t))+"</option>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,r,n,a){var l;return null!=(l=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(r,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:3,column:9}}}))?l:""},useData:!0});new(0,l.default),new(0,c.default)(o.containerPag);var d=a("jkMrE"),f=a("g6yUq"),p=a("gMe87"),h=(l=a("6mZGd"),a("8WKcv"));i=a("cEPyp"),o=a("bGr86");const m=new(0,l.default),g=new(0,h.default);var y=new WeakMap,v=new WeakMap;var w=a("6nUKJ"),M=(i=a("cEPyp"),a("hXrWV")),R=a("8a0sJ");c=a("9M0Rn"),o=a("bGr86");var b=a("hMpod");const I=new(0,l.default);(new(0,w.default)).addGalleryHandler();const C=new class{async getPopularMovies(e){this.genres||(this.genres=await m.fetchGenres(),i.localStorageFilms.addGenres(this.genres));return(await m.fetchTrendingMovies(e)).data}renderCards(t){g.update(t,this.genres),e(d)(this,y).innerHTML=e(d)(this,v).call(this,{movies:t,library:!1}),o.headerRef.scrollIntoView(top),i.localStorageFilms.addItemsOnCurrentPage(t)}async getQueryMovies(e,t=1){if(this.currentQuery=e,!e)return;return await m.getMoviesByName(e,t)}async getMovieDetails(e){if(!e)return;return await m.fetchMoviesByID(e)}constructor(t,r){e(f)(this,y,{writable:!0,value:void 0}),e(f)(this,v,{writable:!0,value:void 0}),e(p)(this,y,t),e(p)(this,v,r),this.currentQuery="",this.genres=null,this.filterIsComplete=!1}}(o.containerGallery,b.default),T=new(0,c.default)(o.containerPag),E=new class{hide(){this.spinnerRef.classList.add("is-hidden"),this.hidden=!0}show(){this.spinnerRef.classList.remove("is-hidden"),this.hidden=!1}constructor(){this.spinnerRef=o.spinnerRef,this.hidden=!0}},P=new(0,R.default),S=new class{renderFilter(){const e=i.localStorageFilms.getItemFromKeyStorage(i.localStorageFilms.LOCAL_STORAGE_KEYS.genres);o.genreSelectRef.insertAdjacentHTML("beforeend",s(e));const t=[];for(let e=2022;e>=1980;e-=1)t.push(e);o.yearSelectRef.insertAdjacentHTML("beforeend",u(t)),this.isEmpty=!1}addHandler(e){o.filterFormRef.addEventListener("change",e)}constructor(){this.isEmpty=!0,this.genreId=null,this.year=null}};async function F(e=1){E.show();try{const t=await C.getPopularMovies(e);E.hide(),C.renderCards(t.results),T.updateTotalItems(t.total_results),T.goToPage(e),T.render(),S.isEmpty&&S.renderFilter()}catch(e){console.error(e)}}async function O(e,t=1){try{const r=await C.getQueryMovies(e,t);if(!r||!r.total_results)return M.NOTIFY_UNCORRECT_SEARCH,P.notifyFailure(),void F();P.notifySuccess(),C.renderCards(r.results),T.updateTotalItems(r.total_results),T.goToPage(t),T.render()}catch(e){console.log(e)}}async function G(e){try{const t=await I.fetchDiscoverMovies(S.genreId,S.year,e);C.renderCards(t.results),T.updateTotalItems(t.total_results),T.goToPage(e),T.render()}catch(e){console.log(e)}}S.addHandler((function(e){e.preventDefault(),C.currentQuery="";const{genre:t,year:r}=e.currentTarget.elements;S.genreId=+t.value,S.year=+r.value,(0!==S.genreId||0!==S.year)&&(C.filterIsComplete=!0,G(1));if(!S.genreId&&!S.year)return C.filterIsComplete=!1,void F()})),o.searchFormRef.addEventListener("submit",(function(e){e.preventDefault();O(e.target.elements.search.value.trim())&&this.reset();o.genreSelectRef.value=0,o.yearSelectRef.value=0,C.filterIsComplete=!1})),T.on("aftermove",(e=>{C.currentQuery||C.filterIsComplete||F(e.page),C.currentQuery&&O(C.currentQuery,e.page),C.filterIsComplete&&G(e.page)})),i.localStorageFilms.saveItemsForArrayAfterReload(),F(),a("bTcpz"),a("16eij"),a("bMZn5");
//# sourceMappingURL=index.59998d22.js.map
